import numpy as np

"""

poly_array = [
[0, 0, -2.11292974 -11.00121303],
[  0.16025369,  -2.97472773,  18.64126121, -44.81631423],
[  -0.72862408,   19.452708,   -167.84051446,  465.90897909],
[ 9.26122253e-01, -3.28690173e+01,  3.80555392e+02, -1.43871719e+03],
[-2.67336996e-01,  1.23576185e+01, -1.84768186e+02,  8.86185471e+02],
[-1.79172666e-01,  1.02278449e+01, -1.88439832e+02,  1.11728468e+03],
[-4.25730999e-02,  2.70503266e+00, -5.92454264e+01,  4.65660579e+02],
[ 1.27027019e-02, -2.34100033e+00,  1.08947968e+02, -1.48167490e+03],
[-4.22196324e-01,  4.25281819e+01, -1.42205263e+03,  1.58164518e+04],
[-3.96780738e-02,  5.17120393e+00, -2.24559685e+02,  3.27364216e+03],
[-2.74980246e-02,  2.55246488e+00, -6.45873885e+01,  2.96941027e+02],
[-1.59231460e-01,  2.26008913e+01, -1.06174437e+03,  1.65781939e+04],
[ 5.41001056e-01, -8.13300745e+01,  4.06922745e+03, -6.76932825e+04],
[-8.54150045e-02,  1.36384129e+01, -7.19576564e+02,  1.26196022e+04],
[-3.78313837e-01,  6.70124488e+01, -3.94972105e+03,  7.75662447e+04],
[ 1.96555111e-01, -3.68477145e+01,  2.30001085e+03, -4.76879348e+04],
[-1.74602880e-01,  3.40546109e+01, -2.20520666e+03,  4.75257604e+04],

[-0.85, 129.534842, -4760.97833],
[0.6, -91.6, 3656.0666666666666],
[-0.65, 110.94999999999999, -4522.299999999999],
[-1.2, 205.545455, -8583.861264824382],
[0.5, -89.6666667, 4230.055558544444],
[-0.65, 128.95, -6114.362499999999],
[-1.0, 197.954545, -9510.500471539255],
[0.6, -117.266667, 6014.779662203704],

]

'''
poly_array = [[0, 0, -2.11292974, -11.00121303],
[0, -0.68538924,   8.45635734, -30.92506365],
[0,  -1.21803016,   27.05919758, -144.77265501],
[0,  0.55494366, -20.36227483, 159.54835887],
[0,  -0.62911887,   24.42150183, -231.034005  ],
[0,  -1.08832353,   49.37887566, -545.774095  ],
[0,  -0.49595229,   20.88081602, -202.07838248],
[0,   -1.11963727,    70.32438121, -1079.07350409],
[0, -8.89130482e-03,  4.95667242e+00, -1.23628476e+02],
[0,  7.26066341e-01, -5.86331035e+01,  1.20996091e+03],
[0, -6.79371960e-01,  6.17741759e+01, -1.34656157e+03],
[0,  6.91600166e-01, -5.73542382e+01,  1.23729090e+03],
[0, -1.55646517e+00,  1.49570247e+02, -3.51864591e+03],
[0, -2.97719384e-01,  3.74306195e+01, -1.07046086e+03],
[0, -1.06630822e+00,  1.32826101e+02, -4.01877629e+03],
[0, -0.04905084,  4.13564291, 46.62817084],
[0, -8.80492780e-01,  1.23816129e+02, -4.20946383e+03],

[ 1.07963682e-05,  2.83970127e-02,  1.72070775e-01, -9.87373222e+00],
]
'''
    
def cul_function(x, idx):
    y = 0
    n = len(poly_array[idx])
    for i in range(n):
        y += poly_array[idx][i] * (x ** (n - i - 1))
    return y

def func2(x):
    y = 1.07963682e-05 * x ** 3 + 2.83970127e-02 * x ** 2 + 1.72070775e-01 * x - 9.87373222e+00
    return y

def func(x):
    y = []

    for i in x:
        if i < 2.256:       #           3
            y.append(cul_function(i, 0))
        elif i < 8.270:     # +5.514    1
            y.append(cul_function(i, 1))
        elif i < 10.276:    # +2.506    2
            y.append(cul_function(i, 2))
        elif i < 13.784:    # +3.508    3
            y.append(cul_function(i, 3))
        elif i < 19.298:    # +5.514    1
            y.append(cul_function(i, 4))
        elif i < 22.807:    # +3.008    2
            y.append(cul_function(i, 5))
        elif i < 26.817:    # +4.511    3
            y.append(cul_function(i, 6))
        elif i < 31.830:    # +5.013    1
            y.append(cul_function(i, 7))
        elif i < 35.839:    # +4.009    2
            y.append(cul_function(i, 8))
        elif i < 38.847:    # +3.008    3
            y.append(cul_function(i, 9))
        elif i < 44.862:    # +6.015    1
            y.append(cul_function(i, 10))
        elif i < 47.869:    # +3.508    2
            y.append(cul_function(i, 11))
        elif i < 50.877:    # +2.507    3
            y.append(cul_function(i, 12))
        elif i < 57.894:    # +6.517    1
            y.append(cul_function(i, 13))
        elif i < 60.902:    # +3.508    2
            y.append(cul_function(i, 14))
        elif i < 64.411:    # +3.509    3
            y.append(cul_function(i, 15))
        elif i < 69.423:    # +5.012    1
            y.append(cul_function(i, 16))
        
        else:
            y.append(func2(i))

        '''
        elif i < 73.0:    
            y.append(cul_function(i, 17))      
        elif i < 76.7:    
            y.append(cul_function(i, 18))
        elif i < 82.5:    
            y.append(cul_function(i, 19))
        elif i < 85.5:    
            y.append(cul_function(i, 20))
        elif i < 89.1:    
            y.append(cul_function(i, 21))
        elif i < 95.0:    
            y.append(cul_function(i, 22))
        elif i < 98.0:    
            y.append(cul_function(i, 23))
        elif i < 101.0:    
            y.append(cul_function(i, 24))
        else:
            y.append(cul_function(i, 24))
        '''
    
    y = np.array(y)
    return y

"""
test_data = [
[1.2531328320802004,-13.585126570883869],
[1.7543859649122806,-14.835843459708817],
[2.2556390977443606,-15.703351869377082],
[2.756892230576441,-13.593599504173627],
[3.258145363408521,-10.203358091826237],
[3.7593984962406015,-6.276665167706884],
[4.260651629072681,-8.693404125927424],
[4.761904761904762,-5.4210052860801134],
[5.263157894736842,-7.468286057466775],
[5.764411027568922,-3.359994211871819],
[6.265664160401002,-6.3144846833232595],
[6.7669172932330826,-5.1912196108778055],
[7.268170426065162,-4.89984722267217],
[7.769423558897243,-8.266361501528184],
[8.270676691729323,-4.168457428915068],
[8.771929824561402,0.044142078840917476],
[9.273182957393484,-0.8428805227831988],
[9.774436090225564,4.83427481096968],
[10.275689223057643,4.332933182249585],
[10.776942355889723,4.395460660667515],
[11.278195488721805,0.34678586060811756],
[11.779448621553884,-2.384900705021724],
[12.280701754385964,-7.125327313311187],
[12.781954887218044,-10.841368838946492],
[13.283208020050125,-12.540918985115576],
[13.784461152882205,-12.60412206710894],
[14.285714285714285,-10.527994887512037],
[14.786967418546364,-9.624772278922725],
[15.288220551378446,-5.962322167498037],
[15.789473684210526,-0.5668634986492096],
[16.290726817042607,-1.1769205325545675],
[16.791979949874687,3.0497777241170216],
[17.293233082706767,4.151558371871871],
[17.794486215538846,3.3667054070866103],
[18.295739348370926,5.858347435623813],
[18.796992481203006,4.994054845728142],
[19.298245614035086,1.6148977237363806],
[19.799498746867165,6.2022298214870615],
[20.30075187969925,7.719805046670219],
[20.80200501253133,9.07483514205838],
[21.303258145363408,13.012276029671137],
[21.804511278195488,14.11449209635412],
[22.305764411027567,14.09342819674644],
[22.807017543859647,14.057072733260327],
[23.308270676691727,15.537777888898923],
[23.809523809523807,12.811017790455232],
[24.31077694235589,13.442591025214545],
[24.81203007518797,11.0303288461221],
[25.31328320802005,7.6446581222029515],
[25.81453634085213,6.769333703724332],
[26.31578947368421,4.297403004397651],
[26.81704260651629,1.029043543439636],
[27.31829573934837,9.18362933350392],
[27.819548872180448,6.960542707302652],
[28.32080200501253,13.265747884718413],
[28.82205513784461,23.64440569072988],
[29.32330827067669,19.573876262064953],
[29.82456140350877,19.875265333611846],
[30.32581453634085,22.967962758664317],
[30.82706766917293,26.144270281078107],
[31.32832080200501,23.93364272703629],
[31.82957393483709,25.72978817506852],
[32.33082706766917,25.49272823840052],
[32.83208020050125,28.074731782217956],
[33.33333333333333,31.717308234783047],
[33.83458646616541,34.335428908674096],
[34.335839598997495,37.20191827263918],
[34.83709273182957,39.72359910075713],
[35.338345864661655,40.126309825166466],
[35.83959899749373,41.55890040439935],
[36.340852130325814,36.68438489669557],
[36.84210526315789,37.296422074255176],
[37.34335839598997,31.6257837076409],
[37.84461152882205,31.1917971282061],
[38.34586466165413,29.309448105380643],
[38.847117794486216,27.899441476292964],
[39.34837092731829,32.457568244485685],
[39.849624060150376,34.85506174197769],
[40.35087719298245,41.726452639426164],
[40.852130325814535,43.15125949680668],
[41.35338345864661,46.88340112059206],
[41.854636591478695,48.12361122775094],
[42.35588972431078,50.04893144543469],
[42.857142857142854,53.42590912472464],
[43.35839598997494,55.060939666334406],
[43.859649122807014,52.32365118492776],
[44.3609022556391,54.851041443536026],
[44.86215538847117,54.53388915183723],
[45.363408521303256,57.89027826868822],
[45.86466165413533,63.041105772654994],
[46.365914786967416,66.04425872608549],
[46.8671679197995,66.4269762743911],
[47.368421052631575,73.40222536487026],
[47.86967418546366,76.18294674859914],
[48.370927318295735,73.81751678810615],
[48.87218045112782,73.95174448465279],
[49.373433583959894,73.08960805763347],
[49.87468671679198,70.16034582312975],
[50.37593984962406,62.95947126439767],
[50.87719298245614,63.784714490640546],
[51.37844611528822,65.29142609662782],
[51.879699248120296,68.72774308650534],
[52.38095238095238,68.59297230649142],
[52.882205513784456,73.69213868617994],
[53.38345864661654,82.06421672514594],
[53.884711779448615,83.75659810651607],
[54.3859649122807,83.65205231653131],
[54.88721804511278,88.39721121024395],
[55.38847117794486,93.32732260993967],
[55.88972431077694,91.47521116790766],
[56.39097744360902,94.70780982570334],
[56.8922305764411,92.64715823061096],
[57.39348370927318,97.19968194952047],
[57.89473684210526,97.68925411975623],
[58.39598997493734,100.3140493950892],
[58.89724310776942,107.61536733537675],
[59.3984962406015,104.65331145372849],
[59.89974937343358,110.9950590812261],
[60.40100250626566,117.98759799694673],
[60.90225563909774,114.84592183466447],
[61.40350877192982,115.65136543217196],
[61.9047619047619,117.7783283452736],
[62.40601503759398,112.1415193283534],
[62.907268170426065,112.87781956554251],
[63.40852130325814,110.65623558820401],
[63.909774436090224,110.4257002425031],
[64.41102756892231,110.0894285872276],
[64.91228070175438,115.33400761541591],
[65.41353383458646,121.42066831321482],
[65.91478696741854,127.87357895768176],
[66.41604010025063,131.49617295565758],
[66.9172932330827,132.28281218565877],
[67.41854636591478,135.638789963362],
[67.91979949874687,139.8014247891127],
[68.42105263157895,141.01146794904952],
[68.92230576441102,140.07046441544387],
[69.4235588972431,142.90837835324936],
[69.92481203007519,144.45719934910147],
[70.42606516290726,147.5345047084495],
[70.92731829573934,150.4965244561726],
]


linear_functions = [
[-2.4951801932057727, -10.458334348821495],
[-1.7306792772881892, -11.799564025869891],
[4.2089559685808915, -25.19723751279262],
[6.763531617633049, -32.23992727208428],
[7.833752383618105, -35.72686209860202],
[-4.821394221649982, 11.84887701894717],
[6.52843568549538, -36.508794264629536],
[-4.084325138916396, 14.0281620420932],
[8.196042231961933, -50.60535043621379],
[-5.894208490545636, 30.61664620981982],
[2.2409138195286804, -20.355298088891445],
[0.5812879144702432, -9.124746851653882],
[-6.716195986317754, 43.91460982074008],
[8.175318624863175, -71.78387462703155],
[8.404136017973206, -73.67634930688894],
[-1.7696100902401082, 15.567037607262918],
[11.325924890837008, -105.87025419721161],
[-1.0001765492965866, 14.610436571011519],
[0.12474231944377223, 3.0511198746820156],
[-8.077106226118486, 91.44196886194445],
[-5.44971469843154, 61.80973358727963],
[-9.457151083537493, 109.01512458978084],
[-7.413502843642441, 83.91769006475383],
[-3.3906025416073113, 32.49715988836505],
[-0.1260901485767576, -10.86603731229144],
[4.14187372329582, -69.69761950602373],
[1.8019291041356773, -36.26983923230739],
[7.306587972292217, -117.66705056595052],
[10.763940044353452, -170.5238115673879],
[-1.2170637826411892, 18.649933069369567],
[8.432263022059827, -138.54461387438135],
[2.198052392270931, -33.85987397567055],
[-1.5657816647465967, 31.22898565696339],
[4.970825846931719, -85.08658660598407],
[-1.7242637168418664, 37.40502696681585],
[-6.741418458373591, 131.71244692041972],
[9.151727535012641, -174.99738803966545],
[3.0275625742403864, -53.74199157324739],
[2.7032850402993827, -47.15891381655035],
[7.855194570787443, -154.32896169387078],
[2.198921053032553, -33.831906804355754],
[-0.04202247971731765, 15.030771729288176],
[-0.07252914965479818, 15.711246321878548],
[2.9540067854990006, -53.31501184829585],
[-5.439886396395146, 142.33212246653022],
[1.2599886033448229, -17.188710860611877],
[-4.812463047289452, 130.43730671119863],
[-6.754413094218693, 178.62102968011976],
[-1.7462722148648382, 51.84854125537299],
[-4.931501745156716, 134.07376471904809],
[-6.5203771246112385, 175.88627470469342],
[16.26839865117825, -435.24129622499953],
[-4.43505781927152, 130.34185046147275],
[12.578884328944346, -342.9783446392693],
[20.70542232299286, -573.1284181549289],
[-8.120706210186555, 257.69984783896393],
[0.6012711977360539, 1.942615576571825],
[6.169931362979696, -164.1402314570107],
[6.33673350721552, -169.1986423473702],
[-4.410201970313452, 162.09786485465065],
[3.5833101688242834, -88.32544777497765],
[-0.47293457365266534, 40.78309415348667],
[5.151097069915778, -141.04650033782377],
[7.266940022867466, -210.51402586079917],
[5.2231507444125995, -142.3877165789704],
[5.71864628111031, -159.1526031589683],
[5.030753252095323, -135.53321845344135],
[0.8034078951966279, 11.735203754308259],
[2.858018205569607, -60.871326010752455],
[-9.724658437868953, 390.08675920521637],
[1.2210141692314238, -7.6883104763765004],
[-11.312923541395406, 454.0883420204018],
[-0.8658032259724351, 63.95778387553355],
[-3.755286300536767, 173.30914835152726],
[-2.812963225029911, 137.17495523058778],
[9.093462902544559, -325.3553830586461],
[4.782999527496514, -155.74567130863534],
[13.70842484040979, -511.42051460517996],
[2.8424896804741024, -72.97049937970405],
[7.445622539451932, -261.0182828417055],
[2.4742191637819673, -55.433932720015946],
[3.8410138342790248, -112.64062694883978],
[6.737070470183511, -235.30568245456925],
[3.26188593051144, -86.36920218290834],
[-5.460890520406295, 291.8363933080109],
[5.042143565923482, -168.82299644329578],
[-0.6327188219391076, 82.91901925888033],
[6.695996288117669, -245.8629368063248],
[10.275900870413807, -408.2596108403086],
[5.991290142093774, -211.74738946623165],
[0.7635215088696725, 30.642885507817482],
[13.915621935505953, -585.758813685411],
[5.547539160539031, -189.37594539750535],
[-4.719032771183606, 302.08150797568305],
[0.26778425461054667, 60.86454407135534],
[-1.7199621719035747, 158.01004611903772],
[-5.843878157834922, 361.6219381562496],
[-14.36574474467055, 786.6473644169746],
[1.6463602363545533, -19.977472973012482],
[3.005889653944564, -89.14651351706561],
[6.8554523948056385, -286.9310653658167],
[-0.26886770612776445, 82.67651881794609],
[10.172836927478613, -464.2699143709606],
[16.70229568773692, -809.5620944247203],
[3.3763008558334207, -98.17440039077337],
[-0.208568851019578, 94.9952705298765],
[9.466591992956609, -431.19768765128356],
[9.835572242393113, -451.449987056445],
[-3.6949623268538687, 297.9856369544759],
[6.449034322302339, -268.95953917630686],
[-4.110999932209268, 326.53111427359363],
[9.082284819224554, -424.064283865624],
[0.9766964796203297, 41.14366845752738],
[5.2364665742892385, -205.4746001812],
[14.566129290873846, -750.2894906484198],
[-5.909301483888271, 455.65693342904706],
[12.651786516857698, -646.843782404736],
[13.950115136862536, -724.6133413473817],
[-6.267643943753228, 496.5595755519662],
[1.6068599770274261, 16.984524737505126],
[4.243291011637723, -144.90159142277662],
[-11.24543398875565, 813.9242419349102],
[1.4689189731922738, 20.47213979831031],
[-4.432060034790339, 391.6866087215258],
[-0.4599180146733204, 139.81895681937021],
[-0.6708619522746062, 153.30033629012905],
[10.46293516123572, -563.8389765349712],
[12.142888092108905, -672.8885527495477],
[12.873556735711617, -720.6841707897274],
[7.227075025961682, -348.4975317761309],
[1.5693452638523695, 27.26647498049715],
[6.6951756665180255, -315.7402211377266],
[8.304456477372526, -424.23559410009693],
[2.4140361040739435, -24.159423382327077],
[-1.8773020495432888, 269.4584502862199],
[5.661638305922054, -250.14270203281558],
[3.0898978867248843, -71.60332957226274],
[6.139224191899359, -284.8268982799491],
[5.909229396707644, -268.62926984664955],
]

def make_linear_function(idx):
    p = test_data[idx - 1]
    q = test_data[idx]
    a = [[p[0], 1], [q[0], 1]]
    b = [p[1], q[1]]
    n = np.dot(np.linalg.inv(a), b)
    return n

def func2(x):
    y = 1.07963682e-05 * x ** 3 + 2.83970127e-02 * x ** 2 + 1.72070775e-01 * x - 9.87373222e+00
    return y

def func3(x):
    y = 1.1019923411760573e-05 * x ** 3 + 0.02873123966598277 * x ** 2 + 0.14687703347402845 * x + (0.0006370411062008171 * x ** 2 + -0.05141220111376674 * x + -3.369478181936184) * np.sin(x) + -9.506103977589806
    return y

def func(x):
    y = []

    for i in x:
        n = 1
        while(True):
            if n >= len(test_data):
                y.append(func3(i))
                break
            elif i < test_data[n][0]:
                f = linear_functions[n - 1]
                y.append(f[0] * i + f[1])
                break
            else:
                n += 1
                continue

    y = np.array(y)
    return y